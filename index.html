<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mics Messenger Ultimate</title>
    
    <!-- ИСПРАВЛЕННАЯ ССЫЛКА НА БИБЛИОТЕКУ -->
    <script src="https://cdn.socket.io"></script>

    <style>
        :root { --accent: #00d2ff; --bg: #121217; --panel: #1e1e26; }
        body { 
            font-family: 'Inter', sans-serif; 
            background: var(--bg); 
            color: #fff; 
            margin: 0; 
            height: 100vh; 
            display: flex; 
            flex-direction: column; 
            overflow: hidden;
        }

        /* Шапка */
        header { background: var(--panel); padding: 15px 20px; border-bottom: 2px solid var(--accent); display: flex; justify-content: space-between; align-items: center; }
        .logo { font-size: 20px; font-weight: 800; color: var(--accent); letter-spacing: 1px; }
        #status { font-size: 11px; font-weight: bold; transition: 0.3s; color: #555; }

        /* Чат */
        #chat { flex: 1; overflow-y: auto; padding: 20px; display: flex; flex-direction: column; gap: 12px; }
        .msg { padding: 10px 15px; border-radius: 15px; max-width: 75%; font-size: 14px; position: relative; animation: fadeIn 0.2s ease; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(5px); } to { opacity: 1; transform: translateY(0); } }
        
        .my { align-self: flex-end; background: var(--accent); color: #000; border-bottom-right-radius: 2px; }
        .other { align-self: flex-start; background: #2d2d3a; color: #fff; border-bottom-left-radius: 2px; }
        .nick { font-size: 10px; font-weight: bold; margin-bottom: 3px; display: block; opacity: 0.7; }

        /* Ввод */
        .input-bar { background: var(--panel); padding: 20px; display: flex; gap: 10px; border-top: 1px solid #333; }
        input { background: #2d2d3a; border: 1px solid #444; color: #fff; padding: 12px; border-radius: 10px; outline: none; }
        #n-in { width: 90px; color: var(--accent); font-weight: bold; text-align: center; }
        #m-in { flex: 1; }
        button { background: var(--accent); color: #000; border: none; padding: 0 20px; border-radius: 10px; font-weight: bold; cursor: pointer; }
    </style>
</head>
<body>

<header>
    <div class="logo">MICS ULTIMATE</div>
    <div id="status">ПОДКЛЮЧЕНИЕ...</div>
</header>

<div id="chat"></div>

<div class="input-bar">
    <input type="text" id="n-in" placeholder="Ник" maxlength="10">
    <input type="text" id="m-in" placeholder="Сообщение..." onkeypress="if(event.key==='Enter') send()">
    <button onclick="send()">></button>
</div>

<script>
    // Твоя ссылка от Render (убедись, что она верная!)
    const socket = io('https://mics-server.onrender.com', {
        transports: ['websocket', 'polling']
    });

    const nickIn = document.getElementById('n-in');
    const msgIn = document.getElementById('m-in');
    const chat = document.getElementById('chat');
    const statusText = document.getElementById('status');

    // Авто-ник
    nickIn.value = "User" + Math.floor(Math.random() * 99);

    socket.on('connect', () => {
        statusText.innerText = "В СЕТИ";
        statusText.style.color = "#00ff88";
    });

    socket.on('message', (data) => {
        const isMy = data.user === nickIn.value;
        const div = document.createElement('div');
        div.className = `msg ${isMy ? 'my' : 'other'}`;
        div.innerHTML = `<span class="nick">${data.user}</span>${data.text}`;
        chat.appendChild(div);
        chat.scrollTop = chat.scrollHeight;
    });

    function send() {
        const text = msgIn.value.trim();
        if (text && socket.connected) {
            socket.emit('message', { user: nickIn.value, text: text });
            msgIn.value = "";
        }
    }

    socket.on('connect_error', () => {
        statusText.innerText = "ОШИБКА СВЯЗИ";
        statusText.style.color = "#ff4444";
    });
</script>

</body>
</html>
